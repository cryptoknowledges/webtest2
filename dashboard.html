<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Arial',sans-serif;}
body{background:#f4f4f9;}
.sidebar{
    width:220px;height:100vh;background:#222;color:white;padding-top:25px;position:fixed;top:0;left:0;transition:0.3s;
}
.sidebar h2{text-align:center;margin-bottom:20px;font-size:24px;color:#ff4500;}
.sidebar a{display:flex;align-items:center;padding:12px 20px;color:white;text-decoration:none;font-size:16px;transition:0.3s;}
.sidebar a i{margin-right:10px;}
.sidebar a:hover, .sidebar a.active{background:#ff4500;border-radius:6px;}
.content{margin-left:240px;padding:30px;min-height:100vh;transition:0.3s;}
.content h1{text-align:center;margin-bottom:30px;color:#222;}
.dashboard-box{display:flex;flex-wrap:wrap;gap:25px;justify-content:center;}
.box{background:white;padding:25px;border-radius:12px;flex:1 1 220px;text-align:center;box-shadow:0 8px 25px rgba(0,0,0,0.1);font-size:18px;font-weight:bold;transition:0.3s;}
.box:hover{transform:translateY(-5px);box-shadow:0 12px 30px rgba(0,0,0,0.2);}
.box i{font-size:28px;color:#ff4500;margin-bottom:10px;display:block;}
</style>
</head>
<body>

<div class="sidebar">
<h2><i class="fas fa-shoe-prints"></i> Admin</h2>
<a class="active" href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
<a href="admin.html"><i class="fas fa-plus"></i> Add Product</a>
<a href="admin-products.html"><i class="fas fa-boxes"></i> All Products</a>
<a href="admin-orders.html"><i class="fas fa-shopping-cart"></i> Orders</a>
<a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
</div>

<div class="content">
<h1>Welcome, Admin!</h1>
<div class="dashboard-box">
<div class="box"><i class="fas fa-box"></i>Total Products: <span id="totalProducts">0</span></div>
<div class="box"><i class="fas fa-exclamation-triangle"></i>Low Stock: <span id="lowStock">0</span></div>
<div class="box"><i class="fas fa-coins"></i>Inventory Value: â‚¹<span id="inventoryValue">0</span></div>
<div class="box"><i class="fas fa-shopping-basket"></i>Total Orders: <span id="totalOrders">0</span></div>
<div class="box"><i class="fas fa-hourglass-half"></i>Pending Orders: <span id="pendingOrders">0</span></div>
<div class="box"><i class="fas fa-check-circle"></i>Completed Orders: <span id="completedOrders">0</span></div>
</div>
</div>

<script>
if(localStorage.getItem("adminLoggedIn")!=="true") window.location.href="login.html";
function logout(){localStorage.removeItem("adminLoggedIn");window.location.href="login.html";}

let products=JSON.parse(localStorage.getItem("adminProducts"))||[];
let orders=JSON.parse(localStorage.getItem("adminOrders"))||[];

/* Fix old orders without orderNumber */
orders = orders.map(o=>{
    if(!o.orderNumber) o.orderNumber = "ORD" + Math.floor(Math.random()*90000+10000);
    return o;
});
localStorage.setItem("adminOrders", JSON.stringify(orders));

function updateDashboard(){
    // Products
    let total=products.length;
    let low=0; let value=0;
    products.forEach(p=>p.sizes.forEach(s=>{if(s.qty<=2) low++; value+=s.qty*p.price;}));
    document.getElementById("totalProducts").innerText=total;
    document.getElementById("lowStock").innerText=low;
    document.getElementById("inventoryValue").innerText=value;

    // Orders
    let totalO=orders.length;
    let pending=orders.filter(o=>o.status==="pending").length;
    let completed=orders.filter(o=>o.status==="delivered").length;
    document.getElementById("totalOrders").innerText=totalO;
    document.getElementById("pendingOrders").innerText=pending;
    document.getElementById("completedOrders").innerText=completed;
}

updateDashboard();
</script>

</body>
</html>
