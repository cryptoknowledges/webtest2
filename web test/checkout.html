<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout - FootWear Shop</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Arial',sans-serif;}
body{background:#f4f4f9;color:#333;}
.container{max-width:1200px;margin:50px auto;padding:20px;display:flex;flex-wrap:wrap;gap:30px;}
.cart-section, .summary-section{background:white;border-radius:12px;padding:25px;box-shadow:0 5px 20px rgba(0,0,0,0.1);}
.cart-section{flex:2;min-width:300px;}
.summary-section{flex:1;min-width:250px;height:fit-content;}
h2,h3{margin-bottom:25px;color:#ff4500;}
.cart-item{display:flex;align-items:center;justify-content:space-between;padding:15px 0;border-bottom:1px solid #eee;}
.cart-item img{width:80px;height:80px;object-fit:cover;border-radius:6px;margin-right:15px;}
.cart-item-details{flex:1;}
.cart-item-details p{margin:5px 0;font-size:14px;}
.cart-item select, .cart-item input[type="number"]{margin-top:5px;padding:5px;border-radius:5px;border:1px solid #ccc;}
.summary-section input{width:100%;padding:10px;margin-bottom:15px;border-radius:6px;border:1px solid #ccc;}
button{
    padding:12px 20px;background:#28a745;color:white;border:none;border-radius:6px;cursor:pointer;
    font-weight:bold;transition:0.3s;width:100%;
}
button:hover{background:#218838;}
.empty-cart{text-align:center;color:#555;padding:20px;font-size:16px;}
a{color:#ff4500;text-decoration:none;}
a:hover{text-decoration:underline;}
@media(max-width:900px){
    .container{flex-direction:column;}
}
</style>
</head>
<body>

<div class="container">
  <div class="cart-section">
    <h2>Your Cart</h2>
    <div id="checkoutItems"></div>
    <p style="text-align:center;margin-top:15px;">
        <a href="index.html"><i class="fas fa-arrow-left"></i> Continue Shopping</a>
    </p>
  </div>

  <div class="summary-section">
    <h3>Order Details</h3>
    <input type="text" id="customerName" placeholder="Full Name" required>
    <input type="tel" id="customerPhone" placeholder="Phone Number" required>
    <div id="checkoutTotal">Total: ₹0</div>
    <button id="confirmOrderBtn">Place Order</button>
  </div>
</div>

<script>
let cart = JSON.parse(localStorage.getItem("cart")) || [];
const checkoutItemsDiv = document.getElementById("checkoutItems");
const checkoutTotalDiv = document.getElementById("checkoutTotal");
const confirmOrderBtn = document.getElementById("confirmOrderBtn");

function renderCheckout(){
    if(cart.length === 0){
        checkoutItemsDiv.innerHTML = '<p class="empty-cart">Your cart is empty!</p>';
        checkoutTotalDiv.textContent = 'Total: ₹0';
        confirmOrderBtn.style.display = 'none';
        return;
    }

    confirmOrderBtn.style.display = 'block';
    checkoutItemsDiv.innerHTML = '';
    let total = 0;

    cart.forEach((item,index)=>{
        total += (item.price || 0) * (item.qty || 1);

        let sizeSelectHTML = '';
        if(item.sizes && Array.isArray(item.sizes) && item.sizes.length > 0){
            sizeSelectHTML = `<label>Size:
                <select class="sizeSelect" data-index="${index}">
                    ${item.sizes.map(s=>`<option value="${s.size}" ${item.selectedSize===s.size?'selected':''}>${s.size}</option>`).join('')}
                </select>
            </label>`;
        }

        checkoutItemsDiv.innerHTML += `
        <div class="cart-item">
            <img src="${item.image}" alt="${item.name}">
            <div class="cart-item-details">
                <p><strong>${item.name}</strong></p>
                <p>Price: ₹${item.price}</p>
                ${sizeSelectHTML}
                <label>Quantity:
                    <input type="number" min="1" class="qtyInput" data-index="${index}" value="${item.qty}">
                </label>
            </div>
        </div>`;
    });

    checkoutTotalDiv.textContent = 'Total: ₹' + total;

    document.querySelectorAll('.qtyInput').forEach(input=>{
        input.addEventListener('change', (e)=>{
            let idx = e.target.dataset.index;
            let val = parseInt(e.target.value);
            if(isNaN(val) || val < 1) val = 1;
            cart[idx].qty = val;
            localStorage.setItem("cart", JSON.stringify(cart));
            renderCheckout();
        });
    });

    document.querySelectorAll('.sizeSelect').forEach(select=>{
        select.addEventListener('change', (e)=>{
            let idx = e.target.dataset.index;
            cart[idx].selectedSize = e.target.value;
            localStorage.setItem("cart", JSON.stringify(cart));
        });
    });
}

confirmOrderBtn.addEventListener("click", ()=>{
    const customerName = document.getElementById("customerName").value.trim();
    const customerPhone = document.getElementById("customerPhone").value.trim();

    if(!customerName || !customerPhone){
        alert("Please enter your name and phone number.");
        return;
    }

    let total = cart.reduce((acc,item)=>acc + (item.price || 0) * (item.qty || 1),0);

    let orders = JSON.parse(localStorage.getItem("adminOrders")) || [];

    orders.push({
        customerName,
        customerPhone,
        items: cart.map(i=>({
            name:i.name,
            qty:i.qty,
            price:i.price,
            size:i.selectedSize || (i.sizes && i.sizes[0] ? i.sizes[0].size : ''),
            image:i.image
        })),
        total,
        status: "pending",
        date: new Date().toLocaleString()
    });

    localStorage.setItem("adminOrders", JSON.stringify(orders));
    localStorage.removeItem("cart");

    alert("Thank you! Your order has been placed.");
    window.location.href = "index.html";
});

renderCheckout();
</script>

</body>
</html>
